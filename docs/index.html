---

title: ohawf


keywords: fastai
sidebar: home_sidebar

summary: "Google OAuth2 login that's not oh... awful."
description: "Google OAuth2 login that's not oh... awful."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install -U ohawf</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Google services require OAuth2 login which is often hard for newbs. If you're trying to do Python things with your Google data (GA, GSC, Sheets, Photos, etc.) and have failed in the past over login issues (should be the easy part but is not), ohawf is for you. It simplifies processes like <a href="https://developers.google.com/webmaster-tools/search-console-api-original/v3/quickstart/quickstart-python">GSC API quickstart</a> for example.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
<pre><code>import ohawf
cred = ohawf.get()

</code></pre>
<p>If it is your first time running you will get a link for the Web-based Google OAuth2 login prompt that looks like:</p>

<pre><code>Please visit this URL to authorize this application: https://accounts.google.com/o/oauth2/auth?response_type=code&amp;client_id=[foo]&amp;redirect_uri=[foo]&amp;state=[foo]&amp;prompt=consent&amp;access_type=offline
Enter the authorization code:_________________________

</code></pre>
<p>Click it and from the familiar Google login prompt that pops-up pick the account you want to use. If you get a security warning you have to click <strong><em>Advanced</em></strong> and <strong><em>Go to OhAwf (unsafe)</em></strong>. If this bothers you, you can optionally create your own credentials.json file as described below. Copy/paste the resulting text (a.k.a. "token") back into the Jupyter field and hit Enter. You will then have the authenticated <strong><em>credentials object</em></strong> needed to connect to and interact with Google services.</p>
<h3 id="Security">Security<a class="anchor-link" href="#Security"> </a></h3><p>This process deposits a credentials.pkl file in that folder that will be continually refreshed keeping you from having to log in again. Keep both your credentials.json and credentials.pkl file secret. In other words, do not commit them to your Github repos. Add them both to your .gitignore file.</p>
<h3 id="Custom-Credentials-File">Custom Credentials File<a class="anchor-link" href="#Custom-Credentials-File"> </a></h3><p>By default, the credentials-default.json file will be used from my Pipulate project. There is nothing wrong with this because I don't use that account for anything other than this, but it is unverified by Google and will cause an OAuth2 security warning on the prompt. If you wish to provide your own credentials.json file (optional), follow the below process.</p>
<ul>
<li>Go to <a href="https://console.cloud.google.com/">https://console.cloud.google.com/</a></li>
<li>Create a new Project.</li>
<li>Go to API &amp; Services.</li>
<li>Enable the APIs &amp; Services you want to use.</li>
<li>Go to Credentials.</li>
<li>Create a new OAuth 2.0 Client IDs of the Desktop App type.</li>
<li>Download that credentials file.</li>
<li>Rename that file to credentials.json</li>
<li>Drop that file into your working directory</li>
</ul>
<p>Rename it to "credentials.json" and drop it into your working folder and it will use it instead of the provided credentials-default.json.</p>
<h3 id="Adding-Scopes">Adding Scopes<a class="anchor-link" href="#Adding-Scopes"> </a></h3><p>If you want to work with more Google services than just Analytics and Search Console (<a href="https://developers.google.com/identity/protocols/oauth2/scopes">there are hundreds</a>) then activate them and add their scope URLs to the scopes.csv file, one per line.</p>
<h2 id="Google-Services">Google Services<a class="anchor-link" href="#Google-Services"> </a></h2><p>After we have an authenticated credentials object, we build Google services objects with <strong><em>build</em></strong> from the Google API Python client installed as a requirement of ohawf.</p>

<pre><code>from apiclient.discovery import build

</code></pre>
<p>Connect to Google services by giving <strong><em>build</em></strong> any (activated) API name, version and credentials such listing your GSC sites:</p>

<pre><code>gsc_service = build('webmasters', 'v3', credentials=cred)
gsc_sites = gsc_service.sites().list().execute()
[print(x['siteUrl']) for x in gsc_sites['siteEntry']];

</code></pre>
<p>...or this go list your GA accounts:</p>

<pre><code>ga_service = build('analytics', 'v3', credentials=cred)
ga_accounts = ga_service.management().accounts().list().execute()
[print((x['id'], x['name'])) for x in ga_accounts['items']];

</code></pre>
<p>Notice how clean this code is compared to <a href="https://developers.google.com/webmaster-tools/search-console-api-original/v3/quickstart/quickstart-python">GSC API quickstart</a>. With better security (OAuth2) comes more complicated procedures. Ohawf is the most lightweight way I have found to alleviate this.</p>
<h2 id="About-the-Author">About the Author<a class="anchor-link" href="#About-the-Author"> </a></h2><p>I used to be Mike Levin, <a href="https://mikelev.in/">SEO in NYC</a>. Since our lovely pandemic I got my butt back to Pennsylvania and am now the <a href="https://www.youtube.com/channel/UCd26IHBHcbtxD7pUdnIgiCw">Poconos Pythonista</a> focusing on the kind of data exploration and automation folks are calling Data Engineering these days. Once upon a time, I worked for legendary Commodore Computers due to my love for the amazing Amiga computer, which spoiled me then caused me to be disappointed with everything to follow. Finally I'm finding the love again using a certain mix of Linux, Python, vim and git (plus Jupyter and Virtual Desktops). Today, I'm part of the J2 family of sites including <a href="https://mashable.com/">Mashable</a>, <a href="https://www.pcmag.com/picks/the-best-seo-tools">PCMag</a>, <a href="https://www.everydayhealthgroup.com/">Everyday Health</a> and <a href="https://www.retailmenot.com/">RetailMeNot</a>. To thank me for this package, visit these sites. In particular if you use browser shopping plugins and mobile apps, try RMN's <a href="https://www.retailmenot.com/mobile">coupon app</a> or <a href="https://www.retailmenot.com/dealfinder/?utm_source=github&amp;utm_medium=employee_miklevin">coupon plugin</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Copyright-(c)-2021-Mike-Levin">Copyright (c) 2021 Mike Levin<a class="anchor-link" href="#Copyright-(c)-2021-Mike-Levin"> </a></h2><p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Privacy-Policy">Privacy Policy<a class="anchor-link" href="#Privacy-Policy"> </a></h1><h2 id="Last-updated:-March-10,-2021">Last updated: March 10, 2021<a class="anchor-link" href="#Last-updated:-March-10,-2021"> </a></h2><p>This app does not collect nor use any of Your Personal data.</p>

</div>
</div>
</div>
</div>
 

